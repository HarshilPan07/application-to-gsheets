(()=>{let e,t="",o=null,s="",n=[];const a=()=>(console.log(o),new Promise((e=>{chrome.storage.sync.get(o,(t=>{e(t?JSON.parse(t[o]).savedJobs:[])}))}))),l=()=>{const e=document.getElementsByClassName("jobs-unified-top-card__primary-description")[0].children[0].textContent,o=e.indexOf("Â·"),s=e.indexOf("("),n=e.indexOf(")"),a=document.getElementsByClassName("t-24 t-bold jobs-unified-top-card__job-title")[0].textContent.trim(),l=e.substring(0,o).trim(),i=e.substring(o+1,s).trim(),c=e.substring(s+1,n).trim(),m=new Date,r=m.getMonth()<9?`0${m.getMonth()+1}`:`${m.getMonth()}+1`,d=`${m.getDate()}`,b=`${m.getFullYear()}`;return{currentJob:t,company:l,title:a,location:i,remote:c,date:`${r}/${d}/${b}`}},i=async()=>{const e=document.getElementsByClassName("job-btn")[0],i=l();if(n.includes(t)){e.src=chrome.runtime.getURL("images/job-btn.png"),e.className="job-btn add-job-btn",e.title="Click to add to Google Sheets",n=await a(),n=n.filter((e=>e!==t));let l={sheetID:s,savedJobs:n};await chrome.storage.sync.set({[o]:JSON.stringify(l)}),await chrome.runtime.sendMessage({type:"DELETE-JOB",jobID:i.currentJob})}else{e.src=chrome.runtime.getURL("images/job-added-btn.png"),e.className="job-btn job-added-btn",e.title="Click to remove from Google Sheets",n=await a(),n.push(t);let l={sheetID:s,savedJobs:n};await chrome.storage.sync.set({[o]:JSON.stringify(l)}),console.log(i),await chrome.runtime.sendMessage({type:"ADD-JOB",jobInfo:i})}};chrome.runtime.onMessage.addListener(((e,n,a)=>{"NEW"===e.type?(console.log("1st"),o=e.user,t=e.jobID,s=e.sheetID,c()):"USER"===e.type&&(console.log("2nd"),o=e.userID,s=e.sheetID)}));const c=async()=>{const o=document.getElementsByClassName("job-btn")[0];let s=await chrome.storage.sync.get();if(console.log(s),n=await a(),console.log("all jobs\n"),console.log(n),l(),n.includes(t)||o){if(n.includes(t)&&o){const e=document.getElementsByClassName("job-btn")[0];e.src=chrome.runtime.getURL("images/job-added-btn.png"),e.className="job-btn job-added-btn",e.title="Click to remove from Google Sheets"}else if(o){const e=document.getElementsByClassName("job-btn")[0];e.src=chrome.runtime.getURL("images/job-btn.png"),e.className="job-btn add-job-btn",e.title="Click to add to Google Sheets"}}else{const t=document.createElement("div"),o=document.createElement("img");o.src=chrome.runtime.getURL("images/job-btn.png"),o.className="job-btn add-job-btn",o.title="Click to add to Google Sheets",t.className="inline-flex btn-container",t.appendChild(o),e=document.getElementsByClassName("mt5")[2],e&&e.firstElementChild&&e.firstElementChild.appendChild(t),o.addEventListener("click",i)}}})();